DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Core.Ef.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF object_id('[core].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [core].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Core.Ef.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201508211346085_Core_Ver3'
BEGIN
    IF schema_id('core') IS NULL
        EXECUTE('CREATE SCHEMA [core]')
    CREATE TABLE [core].[ConstantCategories] (
        [ID] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        [TimeStamp] rowversion NOT NULL,
        CONSTRAINT [PK_core.ConstantCategories] PRIMARY KEY ([ID])
    )
    CREATE TABLE [core].[Constants] (
        [ID] [int] NOT NULL IDENTITY,
        [Key] [nvarchar](max) NOT NULL,
        [Value] [nvarchar](max) NOT NULL,
        [ConstantCategoryID] [int] NOT NULL,
        [TimeStamp] rowversion NOT NULL,
        CONSTRAINT [PK_core.Constants] PRIMARY KEY ([ID])
    )
    CREATE INDEX [IX_ConstantCategoryID] ON [core].[Constants]([ConstantCategoryID])
    ALTER TABLE [core].[Constants] ADD CONSTRAINT [FK_core.Constants_core.ConstantCategories_ConstantCategoryID] FOREIGN KEY ([ConstantCategoryID]) REFERENCES [core].[ConstantCategories] ([ID]) ON DELETE CASCADE

    INSERT [core].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201508211346085_Core_Ver3', N'Core.Ef.Migrations.Configuration',  0x1F8B0800000000000400ED5CDD6EDB3614BE1FB0771074B50DA995A4375D60B7489DA430D624459C16BB2B188971844A944B51998D614FB68B3DD25E6187B27E28FEC894E5384D56142B128AFCCEE1E1391F79C8D3FDFBF73FC3378B3872EE314DC3848CDC83C1BEEB60E227414866233763B72F5EB96F5EFFF8C3F0348817CEA7B2DF4BDE0F469274E4DE31363FF2BCD4BFC3314A0771E8D3244D6ED9C04F620F058977B8BFFFAB7770E061807001CB7186571961618CF35FE0D771427C3C67198ACE93004769D10E5FA639AA7381629CCE918F47EE38A178707AEB3AC7518840FC1447F00B222461888172471F533C653421B3E91C1A5074BD9C63E8778BA214174A1FD5DD6DF5DF3FE4FA7BF5C012CACF5296C41D010F5E1606F1E4E11B99D5AD0C06263B05D3B2259F756E366E31923244D818313C4BE8D27564A147E388F201A5757384813C6ECF11BEEE55CE003EC3FFC0D72C6219C52382334651B4E77CC86EA2D0FF0D2FAF932F988C481645A2A6A02B7C6B3440D3079ACC3165CB2B7C5BE83F39711DAF39CE930756C38431AB194D087B79E83A17201CDD44B8720461F65306F37A8709A630D3E003620C5358C74980F3A92AD22559FCEF521A781E448EEB9CA3C57B4C66EC6EE4C28FAE73162E7050B6141A7C2421041A0C6234C3EB845C43B84C198AE7A5A4B721417C2D79EC649442D02ECF73B45C544383577AF91B98649CC4F38C717849DB0B741FCEF2A192DEA513A5AE7385A3BC477A17CE57715BB9D867D547CF68125F259100A174FA7C8DE80C33B048B2AEE734C9A82F1979E8D5A16215405D03E77BC0E865812E5B881745C176A19F50946D234C3B8A953D71BD9D9F370FD401BE7D3A28837C3D1D94C4B1111D9C2EF86105347F9FCC6C29411CF33469E15D16060FCA0A9589B8BC07DF4FCF719AA2D9C3CB8158F5BF5C53E4EF4054E9FEDF4F223A069A10C0A89C4CCB3F62947E96FBD70CD4D24DE1A0B6BEBD58A803F97CE71C9328C815E92478F09019E7CBB42BCA19530CC63881FF4A51FC671EB69D4F1B4D871D27193F04F739BE802BEE84DE9F2A4935CF161A8AE234D2EC54F392FC4D2123A54317063A4ED3C40F737DA4339D7A5C6BCEF694048EF5D96DE517E269101607D8299C031F815A23F717C59C3602AA5C5115509F329B820E5C99E02EC9098E30C3CEB1BFBAEB19A3D44781EA8E60C3A0D9029C8829672514E572290A09530934247E384791ED7424004B0EE60A56A2E42F27788E09E74FDB35B3D1419706A93A55A22563AEB3DDD0139CB3DD67DBB678935359EDF7B55B35C3D3DE776D8E0A9662F607830339AAAD4DA4508C496133DFD45A76B48191A1B63FF115CB813F31F0264C2B47A5F8E486B7E285EEC2074E0CC5192B2D7622792A1C758A99DEF1439CBA4ECDAF4622520CA4476D035B0B22DA5107D4B4F31A3003866EA8B01EEA8C34A9BFD07FED3D814C295DB69E6A4A0DFB2A2CD565B3D1408A8E206F1A4DCB5858AD356151ED664D7E9DE94F98A8E4562DF6B3213C5BE00D8CA71EA5548BB573A11D1B0A53586B1223FF6DC10EE5C1AEA2BCFA99CD5BBDB395EF719EE1416E788EE67338B00B0F74458B332D5EE75E4CBBBF60C52B0CCF4F350F5995B69524386B431A257DE50116E0B390A60CB21D7483F8097D1CC49A6E22C11B48AD9465E47075054BE22B87F29FEB2D6570AA6179F5E0540C3E8309C6FC0496E7156612D140E46FA628425493548F93288B89F950681EBD7AE212C7AF5AEC1184844C84119A55ACA127D94339302A66574EE1CD05EDB4DCFD56B9C7EAEE6A55F377187178DE603FBE785211118A267B0C5D622002DA240E66F427E4754D56DFC4F3DAF6290BEF6B1FFE301E28DDF98B40D2277BCCEA9A4D44AB1AED71C49B7B114A6CEF80561C061A489A47E9769427E4CF1BBBF166DEBB43A72D2F8D4584B2AD03F135EF841B9CD7FCD40153B8F96D000AEDF668DACBDF86D9741DECF1ABBB6011B36A7CDA41D13C849B995E49DADA695DE9DE85C4799AD172DD6CC8C054D3D98554134C7FDF2728D44F57E34DE4C6E1DFAA1C1C4A8230BF319BA4FC59A07A12E864013955EBEC486A02AB6553A98F05736AAC6F4A4C3734797331FB3B8729F9FEA63C62CDA4D7FB8392C1CB5D2A5AAB327929631F16D9B34D9DAD944EAFBAB80E98E03E0C782A3D5DA60CC703DE6130FD1A8DA310F31DA0EC708E48788B53B67A41760FF70F0EA5AADD6FA782D64BD320D2DC3EB495D1EEFC393CE4D65DFBE2DDF14556AC5E25F788FA7788FE14A3C5CF22D2464FAE34F9A3282C376A5D3F90B66ADDBD52F379AC8D5028695C9AEEC58FFDA0CC058DA1B642764202BC18B97FE6C38F9CC9EFCA6DF9E464CFB9A4401847CEBEF357FF8AC847F0BB96E7B21DF85E46C2AF190E732FBB0D31DDBE236A6BF37AB185540CD30B4BADB1EB07D778C5FC563951E310EA81D3E41F1651AAA0998254B543A71AB667182DCDAAB25E0EA4AD1CEB87A8548705F033DB727558BE17F4AB0D7B3A81A79CEB7B849D84D53FE8B659B655BFC93F561595AAD3862563BDCAB15A5EF01EACFCEAFF5566D5A3E0C788B9CA39372ED4DAC863D6BCC96CDD5B94F95AC9B4B9ABDB81D358179E3D84A7C850CFC7276CC558DCC96DDD094C4578722987E1C9C9F88FCB2C4AEC56F75923D787C300ACFC6A5FB5A8D232096F2DC56B15B65E46D3AFD754EA6965B5170D69AAF94CC57C5A742DE8E3D6F9C9BEA0AF9FB129EFD3223CC5E23D6315997595DE6A0BB54479FC92BCFE939707769B66878A3BF55E1E5855F8BF6400ABA7E1AC86E02F0E04FB0D3EADFA4CC86D52F2BBA451D945B98E6108F240744C2157413E83CF3E249DF93FCEC92F0FC166F10D0E26E432639025C194717C133502886F0F6DF2F3B2C2A6CEC3CB7C15D26D4C01D40C792A7B49DE666114547A9F69EEF50C107CDF29F242BE968CE787B365857491104BA0C27CD576798DE3790460E92599A27BBC896E1F53FC1ECF90BF2C9F57CC20EB17A269F6E149886614C56981518F875FC1878378F1FA3F765DE7C62C460000 , N'6.1.2-31219')
END

